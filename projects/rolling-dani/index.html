<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rolling Dani</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background-color: #87ceeb; /* blue sky */
    font-family: sans-serif;
  }
  canvas {
    display: block;
    background-color: #87ceeb; /* same sky color */
  }
  /* Back button styled like the round audio button */
  #back {
    position: absolute;
    bottom: 20px;
    left: 20px;
    width: 48px;
    height: 48px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: #fff;
    font-size: 24px;
    cursor: pointer;
    user-select: none;
  }
</style>
</head>
<body>
<a id="back" href="../../index.html">‚Üê</a>
<canvas id="game"></canvas>

<script>
/* Basic setup */
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let width = window.innerWidth;
let height = window.innerHeight;
canvas.width = width;
canvas.height = height;

const groundY = height * 0.8;       // ground position
const gravity = 0.6;                // gravity strength
const jumpVelocity = 14;            // jump power
const moveSpeed = 6;                // obstacle movement speed

// Load images
const ballImg = new Image();
ballImg.src = 'DaniBall.png';

const obstacleImages = [
  'obsticle 1 coconut.png',
  'obsticle 2 pickle.png',
  'obsticle 3 tomato.png'
].map(src => {
  const img = new Image();
  img.src = src;
  return img;
});

// Ball object
const ball = {
  x: width * 0.15,
  y: groundY - 50,
  radius: 50,
  vy: 0,
  draw() {
    ctx.drawImage(ballImg, this.x - this.radius, this.y - this.radius,
                  this.radius * 2, this.radius * 2);
  },
  update() {
    this.y += this.vy;
    this.vy += gravity;
    // keep ball on ground
    if (this.y + this.radius > groundY) {
      this.y = groundY - this.radius;
      this.vy = 0;
    }
  }
};

// Obstacles array
const obstacles = [];
function spawnObstacle() {
  const img = obstacleImages[Math.floor(Math.random() * obstacleImages.length)];
  obstacles.push({
    x: width + Math.random() * width,
    y: groundY - 60,
    width: 60,
    height: 60,
    img
  });
}

// Game loop
function update() {
  // Randomly spawn obstacles
  if (Math.random() < 0.02) spawnObstacle();

  // Move obstacles left
  obstacles.forEach(ob => ob.x -= moveSpeed);
  // Remove offscreen obstacles
  while (obstacles.length && obstacles[0].x + obstacles[0].width < 0) {
    obstacles.shift();
  }

  ball.update();
}

function draw() {
  // Clear screen
  ctx.clearRect(0, 0, width, height);

  // Draw ground
  ctx.fillStyle = '#44aa44';
  ctx.fillRect(0, groundY, width, height - groundY);

  // Draw ball
  ball.draw();

  // Draw obstacles
  obstacles.forEach(ob => {
    ctx.drawImage(ob.img, ob.x, ob.y, ob.width, ob.height);
  });
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

// Handle jumping
window.addEventListener('keydown', e => {
  if (e.code === 'Space' && ball.vy === 0 && ball.y + ball.radius >= groundY) {
    ball.vy = -jumpVelocity;
  }
});

// Resize handler
window.addEventListener('resize', () => {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
});

ballImg.onload = () => {
  // Start the game once images are ready
  Promise.all(obstacleImages.map(img => new Promise(res => {
    if (img.complete) res();
    else img.onload = res;
  }))).then(() => {
    gameLoop();
  });
};
</script>
</body>
</html>
